2008-02-07  Suman Manjunath  <msuman@novell.com>

	Re-wrote get_folders_list call to suit the other exposed calls. Fixed 
	a couple of memory leaks in the process. 
	Added a few params to ExchangeMAPIFolder, related changes. 

	* exchange-mapi-connection.c: (mapi_profile_load),
	(exchange_mapi_connection_exists), (exchange_mapi_connection_new),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item),
	(exchange_mapi_create_folder), (exchange_mapi_remove_folder),
	(exchange_mapi_rename_folder), (exchange_mapi_create_item),
	(exchange_mapi_modify_item), (exchange_mapi_remove_items),
	(get_child_folders), (set_default_folders), (set_owner_name),
	(set_user_name), (exchange_mapi_get_folders_list),
	(mapi_set_usernames_RecipientType), (exchange_mapi_set_recipients):
	* exchange-mapi-folder.c: (exchange_mapi_folder_new),
	(exchange_mapi_folder_is_root), (exchange_mapi_peek_folder_list),
	(exchange_mapi_folder_get_folder),
	(exchange_mapi_folder_list_free), (exchange_mapi_folder_list_add):
	* exchange-mapi-folder.h:

2008-02-01  Johnny Jacob  <jjohnny@novell.com>	
	
	* exchange-mapi-connection.c (exchange_mapi_connection_fetch_item): Donot free
	the attachment list.

	* exchange-mapi-connection.[ch] (struct ExchangeMAPIAttachment): Added 
	mime_type field for attachments.

2008-02-01  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_util_delete_attachments): Implemented the function. 
	(exchange_mapi_util_get_recipients): Implemented the function. 
	(exchange_mapi_util_get_attachments),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item): RecipientTable handling. 
	* exchange-mapi-connection.h: Initialize RecipientType enum. 
	* exchange-mapi-folder.h: 
	* exchange-mapi-utils.c: (exchange_mapi_util_free_attachment_list),
	(exchange_mapi_util_free_recipient_list),
	(exchange_mapi_util_free_stream_list): Fixed memory leaks. 
	* exchange-mapi-utils.h: Added (exchange_mapi_util_free_recipient_list)

2008-01-30  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_set_flags): Added.

2008-01-25  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.[ch] (exchange_mapi_rename_folder): Added. 

2008-01-11  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_create_item),
	(exchange_mapi_modify_item): Call SubmitMessage only if recipients
	are present. 
	* exchange-mapi-utils.c: (exchange_mapi_util_find_stream):
	* exchange-mapi-utils.h: Added a utility function to find an 
	ExchangeMAPIStream in a GList. 

2008-01-02  Johnny Jacob  <jjohnny@novell.com>	
	
	** Support for adding recipients
	
	* exchange-mapi-connection.c (mapi_collate_recipients): Added.
	(exchange_mapi_set_recipient_table): parse recipient list.

	
2007-12-21  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_util_read_generic_stream),
	(exchange_mapi_util_read_body_stream),
	(exchange_mapi_util_delete_attachments),
	(exchange_mapi_util_set_attachments),
	(exchange_mapi_util_get_attachments), (exchange_mapi_create_item), 
	(exchange_mapi_modify_item), (get_child_folders), 
	(exchange_mapi_get_folders_list): Make use of function specific 
	TALLOC_CTX for better re-usability. Related changes. 
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item): 
	* exchange-mapi-connection.h: API changes in fetch_item(s) and 
	fetch_item(s)_cb. Added support for using named properties while using
	GetProps. 
	* exchange-mapi-utils.c: (utf8tolinux),
	(exchange_mapi_util_free_attachment_list),
	(exchange_mapi_util_free_stream_list):
	* exchange-mapi-utils.h: New utility functions. 

2007-12-11  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item),
	(exchange_mapi_create_folder), (exchange_mapi_create_item),
	(exchange_mapi_modify_item), (exchange_mapi_remove_items),
	(get_child_folders): Code cleanup
	* exchange-mapi-connection.h: API change for fetch_item_cb (added 
	support for attachments and recipients), defined 'struct id_list' 
	used in remove_items.

2007-12-10  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_create_folder),
	(exchange_mapi_remove_folder), (exchange_mapi_create_item),
	(exchange_mapi_modify_item):
	* exchange-mapi-connection.h: API change for modify_item (added support
	for attachments and recipients); Code cleanup for create_item and
	modify_item.

2007-12-10  Srinivasa Ragavan  <sragavan@novell.com>

	** Fix Suman's build break patch.

	* exchange-mapi-connection.c:
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_create_folder):

2007-12-10  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_remove_folder),
	(exchange_mapi_create_folder):
	* exchange-mapi-connection.h: Code cleanup.

2007-12-10  Johnny Jacob  <jjohnny@novell.com>
	
	** Support for 	GetProps in exchange_mapi_connection_fetch_items.
	
	* exchange-mapi-connection.h: Prototype change for fetch_item/fetch_items
	API change.
	* exchange-mapi-connection.c (exchange_mapi_connection_fetch_item): GetProps
	Support added. Only after successfull openmessage we should do mesg 
	operations. Added GetPropsTagArray.

2007-12-06  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c: Add a new parm to fetch items to enable
	to use restrictions fully.
	(exchange_mapi_connection_fetch_items):
	* exchange-mapi-connection.h:

2007-12-05  Suman Manjunath  <msuman@novell.com>

	* Makefile.am: Added two new files: exchange-mapi-utils.[ch]
	* exchange-mapi-connection.c:
	(exchange_mapi_util_delete_attachments),
	(exchange_mapi_util_set_attachments),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item),
	(exchange_mapi_remove_items), (exchange_mapi_remove_folder),
	(exchange_mapi_create_folder), (exchange_mapi_create_item),
	(exchange_mapi_modify_item), (get_child_folders),
	(exchange_mapi_get_folders_list): Added dummy API (to delete attachments), 
	Use utility APIs for inter-converting UIDs and combination of FID, MID
	* exchange-mapi-connection.h:
	* exchange-mapi-utils.c: (exchange_mapi_util_mapi_id_to_string),
	(exchange_mapi_util_mapi_id_from_string),
	(exchange_mapi_util_mapi_ids_to_uid),
	(exchange_mapi_util_mapi_ids_from_uid),
	(exchange_mapi_util_find_row_propval),
	(exchange_mapi_util_find_array_propval):
	* exchange-mapi-utils.h: Added/moved some utility functions to these
	files. 
	
2007-12-05  Suman Manjunath  <msuman@novell.com>

	Removed unnecessary header files.

	* exchange-mapi-connection.c:
	(exchange_mapi_util_find_row_propval),
	(exchange_mapi_util_find_array_propval): Utility functions.
	(exchange_mapi_util_read_generic_stream),
	(exchange_mapi_util_read_body_stream),
	(exchange_mapi_connection_fetch_items): Read the PR_BODY (or analogues)
	from relevant streams after proper decoding. Utlity function for reading
	generic streams.
	* exchange-mapi-connection.h: Fixed a couple of compliler warnings, 
	declarations for new APIs added. 

2007-12-04  Srinivasa Ragavan  <sragavan@novell.com>

	** Fixup mapi folders.

	* exchange-mapi-connection.c: (get_child_folders),
	(exchange_mapi_get_folders_list):
	* exchange-mapi-folder.c: (exchange_mapi_folder_new),
	(exchange_mapi_folder_list_free), (exchange_mapi_folder_list_add):
	* exchange-mapi-folder.h:

2007-11-28  Johnny Jacob  <jjohnny@novell.com>	
	
	* exchange-mapi-connection.c (mapi_profile_load): Use proper status enums.
	MAPIUninitialize when profile load fails.
	Removed MapiItemType.

2007-11-27  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-folder.c: (exchange_mapi_peek_folder_list): Make a
	warning than a message.

2007-11-27  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_connection_new): Make the
	close function as void.
	* exchange-mapi-connection.h:

2007-11-27  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-folder.c: (exchange_mapi_peek_folder_list): Let the
	caller worry about authentication.

2007-11-26  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_connection_new): Redundant connection check.

	* exchange-mapi-connection.h: Added prototype for exchange_mapi_connection_close.

	* exchange-mapi-connection.c (exchange_mapi_connection_close): Added. 

2007-11-26  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-folder.c (exchange_mapi_peek_folder_list): Check connection 
	and connect before a folder_list call.

	* exchange-mapi-connection.c: Removed MapiItem structs.
	(exchange_mapi_connection_new): Check for connection and load profile.
	(mapi_profile_load): free strings.
	(exchange_mapi_connection_new): call function properly.

2007-11-26  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_create_item): Use callbacks only if they
	are available. Null check for build_name_id and build_props.

2007-11-25  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_set_recipient_table): API to set 
	recipient table. Added.

2007-11-23  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c (exchange_mapi_create_item): Resolve and use
	olFolder if fid is 0.

	* exchange-mapi-folder.c (exchange_mapi_folder_is_root): Utility function Added.
	
	* exchange-mapi-folder.h (ExchangeMAPIFolderType): MAPI_FOLDER_TYPE_NOTE_HOMEPAGE,
	MAPI_FOLDER_TYPE_UNKNOWN Added.

	* exchange-mapi-folder.c (container_class_to_type): Handle unknown types.
	
2007-11-23  Srinivasa Ragavan  <sragavan@novell.com>

	** Implement Create folder.
	* exchange-mapi-connection.c: (exchange_mapi_create_folder),
	(exchange_mapi_get_folders_list):
	* exchange-mapi-connection.h:
	* exchange-mapi-folder.c: (exchange_mapi_container_class):
	* exchange-mapi-folder.h:

2007-11-23  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_util_set_attachments),
	(exchange_mapi_util_get_attachments): Use macros for specifying 
	max read/write sizes while handling attachment streams.

2007-11-22  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_util_set_attachments),
	(exchange_mapi_util_get_attachments),
	(exchange_mapi_connection_fetch_item), (exchange_mapi_create_item):
	* exchange-mapi-connection.h: Set attachments implementation. 

2007-11-19  Suman Manjunath  <msuman@novell.com>	

	* exchange-mapi-connection.c: (exchange_mapi_util_get_attachments),
	(exchange_mapi_connection_fetch_items):
	* exchange-mapi-connection.h: Fetch attachments from server. 
	Note: attachments are fetched in (_fetch_items) only atm. 

2007-11-15  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_connection_fetch_items_list) : Removed. 

2007-11-15  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-folder.c: (container_class_to_type):
	* exchange-mapi-folder.h:
	Changed _JOURNAL to _MEMO.

2007-11-13  Suman Manjunath  <msuman@novell.com>
 
 	* exchange-mapi-connection.c:
 	(exchange_mapi_connection_fetch_items),
 	(exchange_mapi_remove_folder): Added missing LOGNONE()s.
 	* exchange-mapi-connection.h: Fixed a compiler warning.
 	* exchange-mapi-folder.c: (exchange_mapi_folder_get_unread_count),
 	(exchange_mapi_folder_get_total_count): unread_count and total_count
 	were incorrectly swapped, fixed it.
	
2007-11-13  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-folder.c (UNLOCK/LOCK): More information on lock macro printfs.

2007-11-02  Suman Manjunath  <msuman@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_connection_fetch_items): Fetch all items in the folder, 
	instead of a static value.

2007-11-02  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_create_item), (exchange_mapi_modify_item): Add support
	for modify item

2007-10-29  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_remove_folder):
	* exchange-mapi-folder.c: (exchange_mapi_folder_get_folder):
	* exchange-mapi-folder.h: Fix the implentation for remove folder and
	add api to fetch folder from fid.

2007-10-29  Johnny Jacob  <jjohnny@trantor.blr.novell.com>

	* exchange-mapi-folder.c (exchange_mapi_folder_new): Populate 
	unread and total counts.
	(exchange_mapi_folder_get_unread_count): Added. Utility function.
	(exchange_mapi_folder_get_total_count): Added. Utility function.

	* exchange-mapi-connection.c (get_child_folders): Populate
	ExchangeMAPIFolder with  unread and total count data.

	* exchange-mapi-folder.h (_ExchangeMAPIFolder): Adding new
	fields for folder stats. Change prototype for 
	exchange_mapi_folder_new.

2007-10-29  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-folder.c: (exchange_mapi_peek_folder_list): Have a
	static folder list and serve.
	* exchange-mapi-folder.h:

2007-10-29  Srinivasa Ragavan  <sragavan@novell.com>

	** Put the return types well. 

	* exchange-mapi-connection.c: (exchange_mapi_create_item):
	* exchange-mapi-connection.h:

2007-10-26  Johnny Jacob  <jjohnny@novell.com>

	* exchange-mapi-folder.c : Added utility functions to retrive
	ExchangeMAPIFolder members.

2007-10-26  Srinivasa Ragavan  <sragavan@novell.com>
	
	* exchange-mapi-connection.c: (mapi_profile_load),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item),
	(exchange_mapi_remove_items), (exchange_mapi_remove_folder),
	(exchange_mapi_create_item), (exchange_mapi_get_folders_list): Add
	function to create items. And make locks and logs easier.
	* exchange-mapi-connection.h:

2007-10-23  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c: (mapi_profile_load),
	(exchange_mapi_remove_items): Add logs and fix remove contacts.

2007-10-23  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_remove_items): Add
	implementation for remove items.

2007-10-22  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_connection_fetch_item),
	(exchange_mapi_get_folders_list): Fix up the locks again and init the
	msgstores well.

2007-10-22  Sankar P  <psankar@novell.com>

	* Makefile.am:
	* exchange-mapi-connection.c: (utf8tolinux), (get_container_class),
	(get_child_folders), (exchange_mapi_get_folders_list):
	* exchange-mapi-connection.h:
	* exchange-mapi-folder.c: (container_class_to_type),
	(exchange_mapi_folder_new):
	* exchange-mapi-folder.h:

	Moved a few files from the plugin to the servers folder, 
	which is where they are appropriate.

	Now excahange-mapi exposes new header files and hence functions.

2007-10-22  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c: (exchange_mapi_connection_new),
	(exchange_mapi_connection_fetch_item): Make locks verbose and fix more
	locks.

2007-10-22  Srinivasa Ragavan  <sragavan@novell.com>

	* exchange-mapi-connection.c:
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item): Unlock after the fetch is over.

2007-10-22  Srinivasa Ragavan  <sragavan@novell.com>

	** Initial code drop for the Exchange MAPI provider.

	* Makefile.am:
	* exchange-mapi-connection.c: (mapi_profile_load),
	(exchange_mapi_connection_new), (exchange_mapi_connection_exists),
	(exchange_mapi_connection_fetch_items),
	(exchange_mapi_connection_fetch_item):
	* exchange-mapi-connection.h:
	* libexchangemapi.pc.in:
